<div class="document-viewer-container">
  <div class="toolbar">
    @if (document(); as document) {
      <h1>{{ document.name }}</h1>
    }
    <div class="controls">
      <button (click)="decreaseZoom()" class="zoom-button">-</button>
      <span class="zoom-level">{{ zoomLevel() | percent }}</span>
      <button (click)="increaseZoom()" class="zoom-button">+</button>
      <button (click)="saveDocument()" class="save-button">Save</button>
    </div>
  </div>

  @if (pages()) {
    <div class="document-content"
         [style.zoom]="zoomLevel()">
      @for (page of pages(); track page) {
        <div class="page-container">
          <div class="page"
               (mousedown)="startDrawing($event, page)"
               (mousemove)="onDrawing($event)"
               (mouseup)="endDrawing()">
            <img [src]="page.src"/>

            <!--            @for(annotation of document.annotations | annotationsForPage:page.number; track annotation.id) {-->
            <!--              <app-annotation-->
            <!--                [annotation]="annotation"-->
            <!--                [zoomLevel]="zoomLevel$ | async"-->
            <!--              ></app-annotation>-->
            <!--            }-->

            @for (rect of annotations() | annotationsForPage:page.id; track rect) {
              <div class="annotation" [ngClass]="drawing ? 'annotation--dragging' : ''"
                   [ngStyle]="{
                     top: rect.top + 'px',
                     left: rect.left + 'px',
                     width: rect.width + 'px',
                     height: rect.height + 'px'
                   }">
              </div>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
